Version 4
SHEET 1 1604 1652
WIRE -1104 -576 -1728 -576
WIRE 16 -576 -1056 -576
WIRE 912 -576 48 -576
WIRE 1488 -576 944 -576
WIRE 1312 -512 1232 -512
WIRE 1312 -448 1312 -512
WIRE -304 -416 -368 -416
WIRE -192 -416 -240 -416
WIRE 528 -384 496 -384
WIRE 656 -384 608 -384
WIRE 1072 -384 992 -384
WIRE -1408 -352 -1408 -400
WIRE -752 -336 -880 -336
WIRE -688 -336 -752 -336
WIRE -560 -336 -608 -336
WIRE -368 -320 -368 -416
WIRE -320 -320 -368 -320
WIRE -192 -320 -192 -416
WIRE -192 -320 -240 -320
WIRE 1120 -320 1120 -368
WIRE 1232 -320 1232 -512
WIRE 1232 -320 1120 -320
WIRE 1312 -320 1312 -368
WIRE 240 -304 112 -304
WIRE 384 -288 304 -288
WIRE 400 -288 384 -288
WIRE 496 -288 496 -384
WIRE 496 -288 480 -288
WIRE 528 -288 496 -288
WIRE 240 -272 176 -272
WIRE 656 -272 656 -384
WIRE 656 -272 592 -272
WIRE 816 -272 656 -272
WIRE 992 -272 992 -384
WIRE 992 -272 816 -272
WIRE -1408 -256 -1408 -272
WIRE -1328 -256 -1408 -256
WIRE 528 -256 496 -256
WIRE -1408 -240 -1408 -256
WIRE -1328 -240 -1328 -256
WIRE -880 -240 -880 -336
WIRE 496 -240 496 -256
WIRE -752 -224 -752 -336
WIRE -704 -224 -752 -224
WIRE 1312 -224 1232 -224
WIRE -560 -208 -560 -336
WIRE -560 -208 -640 -208
WIRE -496 -208 -560 -208
WIRE -368 -208 -368 -320
WIRE -368 -208 -416 -208
WIRE -320 -208 -368 -208
WIRE -704 -192 -736 -192
WIRE -192 -192 -192 -320
WIRE -192 -192 -256 -192
WIRE -144 -192 -192 -192
WIRE 112 -192 112 -304
WIRE 112 -192 -144 -192
WIRE -320 -176 -352 -176
WIRE 384 -160 384 -288
WIRE 816 -160 384 -160
WIRE 992 -160 816 -160
WIRE 1312 -160 1312 -224
WIRE -352 -144 -352 -176
WIRE -1408 -112 -1408 -160
WIRE 992 -96 992 -160
WIRE 1072 -96 992 -96
WIRE -880 -80 -880 -176
WIRE -848 -80 -880 -80
WIRE -736 -80 -736 -192
WIRE -736 -80 -768 -80
WIRE -688 -80 -736 -80
WIRE -560 -80 -560 -208
WIRE -560 -80 -608 -80
WIRE -880 -48 -880 -80
WIRE 176 -16 176 -272
WIRE 848 -16 176 -16
WIRE 1120 -16 1120 -80
WIRE 1232 -16 1232 -224
WIRE 1232 -16 1120 -16
WIRE 1312 -16 1312 -80
WIRE -1728 32 -1728 -576
WIRE -1104 32 -1104 -576
WIRE -1104 32 -1728 32
WIRE -1056 32 -1056 -576
WIRE 16 32 16 -576
WIRE 16 32 -1056 32
WIRE 48 32 48 -576
WIRE 912 32 912 -576
WIRE 912 32 48 32
WIRE 944 32 944 -576
WIRE 1488 32 1488 -576
WIRE 1488 32 944 32
WIRE -336 112 -1728 112
WIRE 912 112 -256 112
WIRE -2448 192 -2576 192
WIRE -2384 192 -2448 192
WIRE -2016 192 -2304 192
WIRE -1232 240 -1264 240
WIRE -1072 240 -1152 240
WIRE -768 240 -896 240
WIRE -576 240 -688 240
WIRE -2576 256 -2576 192
WIRE 128 272 80 272
WIRE 256 272 208 272
WIRE 544 272 448 272
WIRE 704 272 624 272
WIRE -2448 304 -2448 192
WIRE -2384 304 -2448 304
WIRE -2240 304 -2304 304
WIRE -2016 304 -2016 192
WIRE -2016 304 -2048 304
WIRE -1936 304 -2016 304
WIRE -1376 352 -1440 352
WIRE -1264 352 -1264 240
WIRE -1264 352 -1296 352
WIRE -1232 352 -1264 352
WIRE -1072 368 -1072 240
WIRE -1072 368 -1168 368
WIRE -1008 368 -1072 368
WIRE -896 368 -896 240
WIRE -896 368 -928 368
WIRE -736 368 -896 368
WIRE -1440 384 -1440 352
WIRE -1232 384 -1296 384
WIRE -576 384 -576 240
WIRE -576 384 -672 384
WIRE -448 384 -576 384
WIRE -128 384 -448 384
WIRE -32 384 -128 384
WIRE 80 384 80 272
WIRE 80 384 48 384
WIRE 112 384 80 384
WIRE -2576 400 -2576 336
WIRE -2448 400 -2576 400
WIRE -2240 400 -2448 400
WIRE -1936 400 -2048 400
WIRE -736 400 -800 400
WIRE 256 400 256 272
WIRE 256 400 176 400
WIRE 320 400 256 400
WIRE 448 400 448 272
WIRE 448 400 400 400
WIRE 576 400 448 400
WIRE 112 416 80 416
WIRE 704 416 704 272
WIRE 704 416 640 416
WIRE 784 416 704 416
WIRE 848 416 848 -16
WIRE 848 416 784 416
WIRE 576 432 512 432
WIRE -1296 448 -1296 384
WIRE -800 448 -800 400
WIRE 80 448 80 416
WIRE 512 480 512 432
WIRE -2448 496 -2448 400
WIRE -1936 496 -1936 400
WIRE -1248 592 -1280 592
WIRE -1088 592 -1168 592
WIRE 112 640 80 640
WIRE 256 640 192 640
WIRE -1392 704 -1456 704
WIRE -1280 704 -1280 592
WIRE -1280 704 -1312 704
WIRE -1248 704 -1280 704
WIRE -1088 720 -1088 592
WIRE -1088 720 -1184 720
WIRE -1040 720 -1088 720
WIRE -896 720 -896 368
WIRE -896 720 -960 720
WIRE -1456 736 -1456 704
WIRE -1248 736 -1312 736
WIRE -128 752 -128 384
WIRE -112 752 -128 752
WIRE -16 752 -48 752
WIRE 80 752 80 640
WIRE 80 752 64 752
WIRE 112 752 80 752
WIRE 256 768 256 640
WIRE 256 768 176 768
WIRE 320 768 256 768
WIRE 448 768 448 400
WIRE 448 768 400 768
WIRE 112 784 80 784
WIRE -1312 800 -1312 736
WIRE 80 832 80 784
WIRE 128 976 96 976
WIRE 256 976 192 976
WIRE -1264 1024 -1296 1024
WIRE -1104 1024 -1184 1024
WIRE -1040 1024 -1104 1024
WIRE -896 1024 -896 720
WIRE -896 1024 -960 1024
WIRE 96 1072 96 976
WIRE 128 1072 96 1072
WIRE 256 1072 256 976
WIRE 256 1072 208 1072
WIRE -1408 1136 -1472 1136
WIRE -1296 1136 -1296 1024
WIRE -1296 1136 -1328 1136
WIRE -1264 1136 -1296 1136
WIRE -1104 1152 -1104 1024
WIRE -1104 1152 -1200 1152
WIRE -1472 1168 -1472 1136
WIRE -1264 1168 -1328 1168
WIRE -128 1168 -128 752
WIRE 0 1168 -128 1168
WIRE 96 1168 96 1072
WIRE 96 1168 80 1168
WIRE 128 1168 96 1168
WIRE 256 1184 256 1072
WIRE 256 1184 192 1184
WIRE 320 1184 256 1184
WIRE 448 1184 448 768
WIRE 448 1184 400 1184
WIRE 128 1200 96 1200
WIRE -1328 1232 -1328 1168
WIRE 96 1232 96 1200
WIRE -1264 1296 -1296 1296
WIRE -1104 1296 -1184 1296
WIRE -1040 1296 -1104 1296
WIRE -896 1296 -896 1024
WIRE -896 1296 -960 1296
WIRE -1408 1408 -1472 1408
WIRE -1296 1408 -1296 1296
WIRE -1296 1408 -1328 1408
WIRE -1264 1408 -1296 1408
WIRE -1104 1424 -1104 1296
WIRE -1104 1424 -1200 1424
WIRE -1472 1440 -1472 1408
WIRE -1264 1440 -1328 1440
WIRE -1328 1504 -1328 1440
WIRE -1728 1600 -1728 112
WIRE -336 1600 -336 112
WIRE -336 1600 -1728 1600
WIRE -256 1600 -256 112
WIRE 912 1600 912 112
WIRE 912 1600 -256 1600
FLAG -1328 -240 0
FLAG -1408 -400 V+
FLAG -144 -192 Triangular
FLAG -352 -144 0
FLAG -1408 -112 V-
FLAG -288 -224 V+
FLAG -288 -160 V-
FLAG -672 -240 V+
FLAG -672 -176 V-
FLAG -880 -48 0
FLAG -1200 336 V+
FLAG -1200 400 V-
FLAG -1296 528 0
FLAG -1440 384 0
FLAG -1216 688 V+
FLAG -1216 752 V-
FLAG -1312 880 0
FLAG -1456 736 0
FLAG -1232 1120 V+
FLAG -1232 1184 V-
FLAG -1472 1248 0
FLAG -1232 1392 V+
FLAG -1232 1456 V-
FLAG -1472 1520 0
FLAG -1328 1504 0
FLAG -1328 1232 0
FLAG -704 352 V+
FLAG -704 416 V-
FLAG -800 448 0
FLAG 272 -320 V+
FLAG 272 -256 V-
FLAG 560 -304 V+
FLAG 560 -240 V-
FLAG 496 -240 0
FLAG 816 -272 PWM-
FLAG 816 -160 PWM+
FLAG 144 368 V+
FLAG 144 432 V-
FLAG 144 736 V+
FLAG 144 800 V-
FLAG 160 1152 V+
FLAG 160 1216 V-
FLAG 80 448 0
FLAG 80 832 0
FLAG 96 1232 0
FLAG 608 384 V+
FLAG 608 448 V-
FLAG 512 480 0
FLAG -448 384 Sinal_sensores
FLAG 784 416 Sinal_PID
FLAG 1120 -176 V+
FLAG 1120 -464 V+
FLAG 1312 -16 0
FLAG 1312 -320 0
FLAG -2448 496 0
FLAG -1936 496 0
SYMBOL OpAmps\\LM741 -288 -256 R0
SYMATTR InstName U2
SYMBOL voltage -1408 -368 R0
WINDOW 0 -124 50 Left 2
WINDOW 3 27 81 Left 2
SYMATTR InstName Vbat+
SYMATTR Value 3.7
SYMBOL voltage -1408 -256 R0
WINDOW 0 -118 49 Left 2
WINDOW 3 35 79 Left 2
SYMATTR InstName Vbat-
SYMATTR Value 3.7
SYMBOL res -224 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 470k
SYMBOL cap -240 -432 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL res -400 -224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL OpAmps\\LM741 -672 -272 R0
SYMATTR InstName U1
SYMBOL res -592 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res -752 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res -592 -352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 20k
SYMBOL cap -896 -240 R0
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL voltage -1296 432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 1
SYMBOL OpAmps\\LM741 -1200 304 R0
SYMATTR InstName U3
SYMBOL res -1136 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res -1280 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL voltage -1312 784 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 0
SYMBOL OpAmps\\LM741 -1216 656 R0
SYMATTR InstName U4
SYMBOL res -1152 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res -1296 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL voltage -1472 1152 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3.7
SYMBOL OpAmps\\LM741 -1232 1088 R0
SYMATTR InstName U5
SYMBOL res -1168 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -1312 1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL voltage -1472 1424 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 3.7
SYMBOL OpAmps\\LM741 -1232 1360 R0
SYMATTR InstName U6
SYMBOL res -1168 1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res -1312 1392 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res -912 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res -944 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 22k
SYMBOL res -944 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 22k
SYMBOL res -944 1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL OpAmps\\LM741 -704 320 R0
SYMATTR InstName U7
SYMBOL res -672 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL OpAmps\\LM741 272 -352 R0
SYMATTR InstName U8
SYMBOL OpAmps\\LM741 560 -336 R0
SYMATTR InstName U9
SYMBOL res 496 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res 624 -400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL OpAmps\\LM741 144 336 R0
SYMATTR InstName U10
SYMBOL OpAmps\\LM741 144 704 R0
SYMATTR InstName U11
SYMBOL OpAmps\\LM741 160 1120 R0
SYMATTR InstName U12
SYMBOL res 224 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL res 64 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 10k
SYMBOL res 208 624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 10k
SYMBOL res 80 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 10k
SYMBOL res 224 1056 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 10k
SYMBOL res 96 1152 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 10k
SYMBOL cap -48 736 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL cap 192 960 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 416 1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 10k
SYMBOL res 416 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 10k
SYMBOL res 416 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 10k
SYMBOL OpAmps\\LM741 608 352 R0
SYMATTR InstName U13
SYMBOL res 640 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 10k
SYMBOL nmos 1072 -464 R0
SYMATTR InstName M1
SYMBOL nmos 1072 -176 R0
SYMATTR InstName M2
SYMBOL res 1296 -464 R0
SYMATTR InstName Motor_L
SYMATTR Value 1
SYMBOL res 1296 -176 R0
SYMATTR InstName Motor_R
SYMATTR Value 1
SYMBOL res -2288 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 150
SYMBOL Optos\\PC817D -2144 352 R0
SYMATTR InstName U14
SYMBOL voltage -2576 240 R0
SYMATTR InstName V5
SYMATTR Value 3.7
SYMBOL res -2288 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R32
SYMATTR Value 47k
TEXT -1600 -672 Left 2 !.tran 0 50m 45m
TEXT -1296 944 Left 2 ;Inversor
TEXT -1264 184 Left 2 ;Não inversor
TEXT -1656 1224 VLeft 2 ;Posso otimiar usando o peso da soma diferente para os multiplicadores
TEXT -1608 1088 VLeft 2 ;E usar somente ampop nos inversores
TEXT -1472 -600 Left 2 ;Fonte
TEXT -776 -440 Left 2 ;Oscilador
TEXT -408 -504 Left 2 ;Integrador - Triangular
TEXT -1192 96 Left 2 ;Sensores
TEXT -816 896 VRight 2 ;Pode fazer sinal invertido com NOT
TEXT -792 176 Left 2 ;Somador
TEXT -688 -608 Left 2 ;Gerador da onda triangular
TEXT 536 200 Left 2 ;Somador
TEXT 112 200 Left 2 ;Proporcional
TEXT 104 568 Left 2 ;Derivativo
TEXT 104 912 Left 2 ;Integrativo
TEXT 280 88 Left 2 ;Controlador PID
TEXT 200 -384 Left 2 ;Comparador
TEXT 520 -456 Left 2 ;Inversor
TEXT 432 -608 Left 2 ;Saída para atuação
TEXT 1152 -608 Left 2 ;Atuadores
TEXT 1040 -528 Left 2 ;Motor Esquerda
TEXT 1048 -232 Left 2 ;Motor Direita
TEXT 480 -128 Left 2 ;Pode usar um CI NOT
